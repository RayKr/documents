## 自定义工作流

### 工作流的个人理解

就是把原来需要手动处理的一个业务流程，现在定义好一个处理流程，当出现任务时，会根据配置项，在配置的流程中根据条件流转。所以需要一个工作流驱动、一个任务、一系列的配置。

举例说明：假条请假流程。假条产生后需要一级级的批示的流转过程就是个工作流，假条就是任务的主体，整个流程中，项目经理、部门经理、总经理、人事部门等都是一个个触发事件的点，当假条在流转过程中符合条件，则会由工作流驱动自动流转到下一个事件点，直至任务结束。

工作流可以替代许多企业中任务流转过程，比如青岛有线的工单、工程管理，都可以使用自定义的工作流来简化、规范化流程处理。

### 工作流组织结构的理解

组织结构是工作流的基础。组织结构就好比骨架，比如说企业中的机构、部门、职位、职员这就是组织结构，只有明确定义好的组织结构，才会由相对应的权限划分，才能有流程流转的节点。

在JFlow中的组织结构有两种模式，**一人一部门多岗位**的OneOne模式和**一人多部门多岗位**的OneMore模式。

在`\jflow-web\src\main\resources\jflow.properties`中配置。

如果要把jflow集成进现有的系统，则首先需要集成组织结构。

集成组织结构就是把jflow自带的组织结构表删掉，然后把原系统中的组织结构表创建与jflow这些表同字段的视图即可。

### 关于新建流程时sql语句报错，前台页面卡住的问题

把mysql数据库更换为oracle数据库后发现不再报错。

### H5版和Silverlight版

流程设计H5版可用，表单设计需要使用Silverlight。Chrome不支持Silverlight，只能用IE。

### 创建流程中文乱码问题

将Tomcat7更换为Tomcat8版本后解决。

### 从表插入列时枚举类型无法正确添加的问题

此页面有bug，暂时的解决办法是：插入列-->枚举型-->直接点每个类型后面的“编辑”-->拉到最底下点击“添加到表单”-->在打开的窗口页中修改默认值、是否可编辑等属性-->点击“保存并关闭”-->关闭所有打开过的窗口即可。

### 关于jflow连接远程oracle数据库测试时卡顿的问题

不知道是程序问题，还是由于网络原因，数据库的读写慢，win10不支持oracle11g，本机按照oracle失败，还需排查原因。

### 关于表单设计中，某个字段求和从表某一列的数据不生效的问题

需要排查代码。经过查对数据库，是有记录求和字段的，但是开始节点表单里并未显示出来，在后续的表单中可正常显示。

### 审核组件的使用技巧

一般来说流程，开始节点画表单，后续的都是审核、审核，直到结束。
那么则可以使用审核组件来减少开发量：

1. 在开始节点设计表单.
2. 把表单复制到第2个节点上去, 默认字段都是只读的.
3. 在第2个表单上增加一个审核组件, 这个时候审核组件的状态是启用的.
4. 打开第3个节点属性. 选择"表单"标签页, 填写第二个节点表单的ID值，比如:ND102  选择节点属性的 “审核组件”标签页 => 审核组件状态 设置为 启用。
5. 第n个节点，类似的做法. 

### 集成开发

`\BP\WF\Dev2Interface`这个类里提供对外接口，类似获取待办、在途、挂起任务数。

### jflow与系统集成的的可行性分析

jflow两大功能模块为流程引擎和表单引擎。其中表单负责数据的承载，流程负责表单的流转。表单流转的条件、走向、分合流以及针对表单的操作都是流程引擎在运作。

jflow当前的模式，很适合类似企业OA等办公系统中使用。在针对数据表单的创建、数据填充、流转、运行、条件等都有很丰富的配置项。是否完全适合当前我司各分支系统的使用（例如有线的工单系统、工程管理）等，还需要在分析现有系统业务流转流程后，确定哪些功能模块可用，哪些模块需要二次开发。

关于jflow的集成问题，可使用代码集成，需要当前系统支持spring和SpringMVC，并且进行组织结构的集成（Ccbpm的组织机构集成，就是删除ccbpm的组织机构表，建立同数据结构一样的视图）





