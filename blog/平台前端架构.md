# 平台前端架构

![前端分层示意图](http://swroom.qiniudn.com/frontfenceng.png)

前后端分离，前端接收到后台的数据后，首先是通过“数据解析层”把数据进行解析，解析后的数据可以经过逻辑层添加用户自定义业务逻辑处理，解析生成出的页面元素使用Bootstrap响应式样式表渲染，形成展示给用户的页面内容。

当用户操作页面内容时，jquery会捕捉用户的操作事件并响应相关前端逻辑处理，并将处理完的数据回绑给数据解析层，再将变动后的数据通过标准的Http协议和JSON格式发送给后台进行业务逻辑处理。

![前端组件结构图](http://swroom.qiniudn.com/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84%E5%9B%BE.png)

### 页面样式
为了实现整体架构需求，在页面样式上使用了Bootstrap3的样式表，并且使用了AdminLTE封装的UI模板，保证整站样式统一，界面友好。使用Bootstrap3的优点在于，其提供了成套的样式统一、功能丰富的页面UI控件，前端开发保证了所有控件的样式统一，且简单方便，界面人性化，符合大众审美需求。

### 数据绑定
前后端分离后，前端只负责接收数据，并进行数据的视图展示。在这一方面使用了Vue的数据绑定功能。

![mvvm](http://swroom.qiniudn.com/mvvm.png)

Vue是数据驱动的，无需手动操作页面元素，它通过一些特殊的HTML语法，将页面元素和数据绑定起来。一旦创建了绑定，页面元素将和数据保持同步，每当变更了数据，页面也会相应地更新。在以上MVVM模式结构图上，从View侧看，ViewModel中的DOM Listeners工具会帮我们监测页面上元素的变化，如果有变化，则更改Model中的数据；从Model侧看，当我们更新Model中的数据时，Data Bindings工具会帮我们更新页面中的元素。

* 当接收到后端数据后，Vue解析数据并渲染出页面元素，不再需要手动编写生成页面元素的逻辑，减少工作量。
* Vue数据绑定语法简单，上手容易，其语法规则与html标签语法类似，学习成本低，方便调试。
* 侵入性低，可以与jquery各插件配合使用。

### 数据推送

![pushlet](http://swroom.qiniudn.com/pushlet.png)

由于项目中需要实时推送报警信息，则需引入实时技术。当下的实时技术大致有ajax轮询，长轮询，websocket等，但是由于ajax轮询资源浪费，websocket在ie低版本浏览器上不支持，所以选用较为成熟的Comet（基于长连接的“服务器推”技术），而pushlet就是一个开源comet框架。

pushlet与java程序无缝结合，当页面加载时，由前端向后端发起一个长连接请求，后端接收到以后便会保持该连接，循环定时执行业务逻辑，当有数据变动时，便将数据通过该连接返回给前端，前端接收到变动的数据更新页面内容后，立刻重新发起新一轮的连接。

### 数据grid表格

![datatables](http://swroom.qiniudn.com/DataTables.png)

动态表格的实现，要求不更改代码的前提下，按照后端给出的列与行显示不同的表格。这就要求数据表格在渲染时分两步走，一是优先获取后端的表格配置数据，二是再获取表格的行记录数据。

使用DataTables的优点：
* 支持服务端分页，降低大数据量客户端压力
* 后期可增加丰富的扩展
* 丰富多样的配置，可自定义内容多

### 表单验证

表单验证使用jquery.validate.js进行验证，书写统一格式的配置项即可。该插件已经封装好提示语言显示位置、颜色、字体等，并可以进行自定义修改。

### 页面跳转机制

支持两种方式：ajax局部刷新、整个页面跳转。

平台管理系统可以使用ajax局部刷新方式，整个页面不跳转，当点击链接时是通过公共跳转方法将对应页面的内容加载到内容显示区域。该方式共用所有静态文件，并且在登录系统时只加载一遍，对于后续的操作响应时长有很大提升。

当开发网站类前端页面时，需要使用原生页面url链接跳转机制，符合大众主流对浏览器页面的操作惯性。

### 页面逻辑处理回调

针对需要在前端进行业务逻辑处理的地方（例如金额计算、自定义验证规则、逻辑判断等），需要封装为统一的回调函数，开发人员只关心编写业务逻辑，整体流程控制封装起来。

还未添加，需要后续继续开发。


